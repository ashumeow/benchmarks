<script>

  Base.addFeature({

    $$: function(slctr) {
      return this.root.querySelector(slctr);
    },

    marshalNodeReferences: function() {
      var n$ = this.root.querySelectorAll("[id]");
      if (n$.length) {
        // populate $ with id->node properties from the this.root subtree
        this.$ = {};
        for (var i=0, n; (n=n$[i]); i++) {
          // TODO(sjmiles): this node could come from another host 
          this.$[n.id] = n;
        }
      }
    }

  });
  
</script>